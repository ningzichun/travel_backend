该文件夹为影集应用目录，含影集生成接口代码、影集生成模块及所需资源文件。
 .
├─movie	影集
│  └─modules	影集模块代码
│      └─cost_calculate.py	距离计算
│      └─filelist.py	文件清单
│      └─generate.py	影集生成模块
│      └─genetic.py	遗传模块
│      └─info.py	图片数据（天气、主题色）分析接口
│      └─resources.py	影集程序资源
│      └─templates.py	影集模板数据
│      └─assets	影集数据集
│          ├─fonts	字体
│          ├─gifs	贴图
│          ├─images	背景
│          ├─masks	蒙版
│          ├─music	音乐
│          └─templates	模板


影集生成接口
新建影集
接口地址：/movie/new
请求方式：GET 
接口说明：调用接口后，在服务器 "./media/movies/"+work_id处新增一文件夹
返回参数：
| 状态码 | 返回json中，msg的值 | 说明               |
| ------ | ------------------- | ------------------ |
| 200    | 操作成功            | 作业集将会定期清理 |
| 403    | 未登录或登录超时    |                    |
返回JSON说明：
| 名称    | 说明     |
| ------- | -------- |
| work_id | 作业集号 |

上传文件
接口地址：/movie/$work_id/upload
请求方式： POST
接口说明：文件名将在服务器按时间重新生成
请求参数：
| 名称 | 类型 | 必填 | 说明 |
| ---- | ---- | ---- | ---- |
| file | file | 是   | 文件 |
返回参数：
| 状态码 | 返回json中，msg的值                          | 说明 |
| ------ | -------------------------------------------- | ---- |
| 200    | 操作成功                                     |      |
| 403    | 未登录或登录超时\|找不到作业集\|未获取到file |      |
返回JSON说明：
| 名称     | 说明                                                      |
| -------- | --------------------------------------------------------- |
| filename | 上传后的文件名                                            |
| url      | 相对于根目录地址，"/media/movies/"+$work_id+"/"+$filename |

开始生成影集
接口地址：/movie/$work_id/start
请求方式：GET
说明：调用该接口后，后端启动异步任务。根据不同任务状态，决定是否重新生成。
返回参数：
| 状态码 | 返回json中，msg的值                                          | 说明 |
| ------ | ------------------------------------------------------------ | ---- |
| 200    | 操作成功\|已重新加入队列\|原执行失败，已重新加入队列\|已加入队列 |      |
| 403    | 未登录或登录超时\|找不到作业集\|影集已过期，请重新新建\|任务已完成\|已在 "+task_obj.state+" 队列中 |      |
具体情形：
首先检查文件夹是否存在，不存在，设为 -2（已过期）
| 数据库中保存的status | 数据库中保存的work_id是否有效 | 操作                            |
| -------------------- | ----------------------------- | ------------------------------- |
| 0（未开始）          | -                             | 加入到影集生成队列              |
| 1，2（排队/正处理）  | 是/否                         | 拒绝处理/重新加入到影集生成队列 |
| 3（完成）            | -                             | 拒绝处理                        |

获取作业状态
接口地址：/movie/$work_id/status
请求方式：GET
说明：调用该接口后，后端启动异步任务，需要手动查询处理状态
返回参数：
| 状态码 | 返回json中，msg的值            | 说明 |
| ------ | ------------------------------ | ---- |
| 200    | 操作成功                       |      |
| 403    | 未登录或登录超时\|找不到作业集 |      |
返回JSON说明：
| 名称        | 说明                                                         |
| ----------- | ------------------------------------------------------------ |
| work_id     | 作业ID                                                       |
| uid         |                                                              |
| create_time | 作业创建时间                                                 |
| update_time | 作业更新时间                                                 |
| status      | 作业状态，(0,'未开始'),(1,"排队等待中"),(2,"正在生成"),(3,"已生成"),(-1,"生成失败"),(-2,"已过期被清理") |
| description | 等待用户提供信息\|排队等待中\|正在处理\|处理完成\|生成失败\|找不到任务，请重新启动\|已过期 |
| info        | Celery 任务 ID（完成前） 或 生成的影集链接（/media/movie/$work_id/result.mp4，生成完成后） |
| image_num   | 在服务器上暂存的图片数目                                     |
| image_urls  | 数组，图片的绝对地址                                         |

删除影集
接口地址：/movie/$work_id/delete
请求方式：GET
说明：删除影集文件夹
返回参数：
| 状态码 | 返回json中，msg的值            | 说明 |
| ------ | ------------------------------ | ---- |
| 200    | 操作成功                       |      |
| 403    | 未登录或登录超时\|找不到作业集 |      |

用户影集列表
接口地址：/movie/list
请求方式：GET
注：返回非失败影集（status>=0）
返回参数：
| 状态码 | 返回json中，msg的值 | 说明 |
| ------ | ------------------- | ---- |
| 200    | 操作成功            |      |
| 403    | 未登录或登录超时    |      |
返回JSON说明：
| 名称              | 说明                                                         |
| ----------------- | ------------------------------------------------------------ |
| uid               |                                                              |
| movie_num         |                                                              |
| work_id           |                                                              |
| movie_title       | 影集标题                                                     |
| movie_description | 影集描述                                                     |
| create_time       | 作业创建时间                                                 |
| update_time       | 作业更新时间                                                 |
| status            | 作业状态，(0,'未开始'),(-1,"生成失败"),(-2,"已过期被清理")<br/>100 排队等待中 101 正在分析命令参数 102 正在分析图片 103 正在生成诗词 104 正在匹配模板 105 正在生成影集 200 处理完成 |
| status_msg        | 等待用户提供信息\|排队等待中\|处理完成\|生成失败\|找不到任务，请重新启动\|已过期\|排队等待中 正在分析命令参数 正在分析图片 正在生成诗词  正在匹配模板 正在生成影集 |
| result_msg        | Celery 任务 ID（完成前） 或 生成的影集链接（生成完成后）     |

分享的影集列表
接口地址：/movie/all
请求方式：GET
注：返回所有影集

用户所有影集列表
接口地址：/movie/myall
请求方式：GET
注：返回所有影集
返回参数：
| 状态码 | 返回json中，msg的值 | 说明 |
| ------ | ------------------- | ---- |
| 200    | 操作成功            |      |
| 403    | 未登录或登录超时    |      |
返回JSON说明：
| 名称              | 说明                                                         |
| ----------------- | ------------------------------------------------------------ |
| uid               |                                                              |
| movie_num         |                                                              |
| work_id           |                                                              |
| movie_title       | 影集标题                                                     |
| movie_description | 影集描述                                                     |
| create_time       | 作业创建时间                                                 |
| update_time       | 作业更新时间                                                 |
| status            | 作业状态，(0,'未开始'),(-1,"生成失败"),(-2,"已过期被清理")<br/>100 排队等待中 101 正在分析命令参数 102 正在分析图片 103 正在生成诗词 104 正在匹配模板 105 正在生成影集 200 处理完成 |
| status_msg        | 等待用户提供信息\|排队等待中\|处理完成\|生成失败\|找不到任务，请重新启动\|已过期\|排队等待中 正在分析命令参数 正在分析图片 正在生成诗词  正在匹配模板 正在生成影集 |
| result_msg        | Celery 任务 ID（完成前） 或 生成的影集链接（生成完成后）     |


